name: 🔍 Priority 1: Claude Direct Approval

# SIMPLIFIED: Basic triggers only to test workflow execution
on:
  pull_request:
    types: [opened, synchronize, reopened]
  pull_request_review:
    types: [submitted, dismissed]

# Priority 1: HIGHEST PRIORITY - must run BEFORE all other workflows
concurrency:
  group: priority-1-claude-direct-approval-pr-${{ github.event.pull_request.number || github.run_id }}
  cancel-in-progress: false

jobs:
  claude-direct-approval:
    name: Direct Claude Approval Action
    runs-on: ubuntu-latest
    timeout-minutes: 5

    outputs:
      approval_status: ${{ steps.test-step.outputs.approval_status }}
      pr_number: ${{ steps.get-pr.outputs.pr_number }}
      execution_time: ${{ steps.test-step.outputs.execution_time }}

    permissions:
      contents: read
      pull-requests: write
      issues: write

    steps:
      - name: Simple Priority 1 Test
        id: test-step
        run: |
          echo "🔍 PRIORITY 1: CLAUDE DIRECT APPROVAL TEST"
          echo "📋 EVENT: ${{ github.event_name }}"
          echo "📋 ACTOR: ${{ github.actor }}"
          echo "🎯 PR Number: ${{ github.event.pull_request.number || github.event.number || 'N/A' }}"
          echo "✅ Priority 1 workflow is working!"
          echo "approval_status=success" >> $GITHUB_OUTPUT
          echo "execution_time=$(date -u '+%Y-%m-%d %H:%M:%S UTC')" >> $GITHUB_OUTPUT
      - name: Get PR Number
        id: get-pr
        run: |
          if [ "${{ github.event_name }}" = "pull_request" ]; then
            PR_NUMBER=${{ github.event.number }}
          elif [ "${{ github.event_name }}" = "pull_request_review" ]; then
            PR_NUMBER=${{ github.event.pull_request.number }}
          else
            echo "❌ Unsupported event type: ${{ github.event_name }}"
            exit 1
          fi
          echo "🎯 PR Number: $PR_NUMBER"
          echo "pr_number=$PR_NUMBER" >> $GITHUB_OUTPUT

      - name: Simple Success Step
        run: |
          echo "✅ Priority 1 workflow completed successfully!"
          echo "🎯 PR Number: ${{ steps.get-pr.outputs.pr_number }}"
          echo "🔗 Priority 2 can now execute"


